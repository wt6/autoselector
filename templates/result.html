{% extends "layout.html" %}

{% block scripts %}
    <!-- Pass variables to javascript and load result.js -->
    <script>
        var age = {{selected_age|tojson}};
        var make = {{make|tojson}};
        var model = {{model|tojson}};
        var depreciation = {{depreciation|tojson}};
    </script>
    <script src="static/result.js"></script>
{% endblock %}

{% block title %}
    Result
{% endblock %}

{% block heading %}
    <h2>Depreciation Estimate</h2>
{% endblock %}

{% block main %}
    <!-- Heading displaying selected make, model and age. Lines stating estimated past and future depreciation to be completed by javascript code. -->
    <div><h3>Make: {{make}} &emsp; Model: {{model}} &emsp; Age: {{selected_age}} Year{% if selected_age > 1 %}s{% endif %} Old</h3></div>
    </br>
    <h4>
        <div id="pastDepreciation"></div>
        </br>
        <div id="futureDepreciation"></div>
    </h4>

    <!-- Div container to hold graph generated by js script -->
    <div id="graph" style="height: 400px;"></div>
    </br></br>

    <!-- Holds table of age against price -->
    <div class="container">
        <table class="table table-striped table-sm">
            <tr>
                <th>Age</th>
                <th>*Purchase Price</th>
                <th>*Average Maintenance </br> (per annum)</th>
                <th>Annual Depreciation Rate</th>
            </tr>

            {# Iterate through list of values #}
            {% for value in depreciation %}
                {% set count = loop.index - 1 %}

                {# Make table row for selected age 'active' (highlighted) #}
                {% if count == selected_age %}
                    <tr class="table-success">
                {% else %}
                    <tr>
                {% endif %}

                    {# Fill in age column of table #}
                    {% if count == 0 %}
                        <td>0 years old</td>
                    {% elif count == 1 %}
                        <td>1 year old</td>
                    {% else %}
                        <td>{{count}} years old</td>
                    {% endif %}

                    {# Fill in remaining columns, leaving out formating characters where data is unavailable #}
                    {% if value == 'unavailable' %}
                        <td>{{value}}</td>
                    {% else %}
                        <td>£{{value}}</td>
                    {% endif %}
                    {% if maintenance[count] == 'unavailable' %}
                        <td>{{maintenance[count]}}</td>
                    {% else %}
                        <td>£{{maintenance[count]}}</td>
                    {% endif %}
                    {% if rate[count] == 'unavailable' %}
                        <td>{{rate[count]}}</td>
                    {% else %}
                        <td>{{rate[count]}}%</td>
                    {% endif %}
                </tr>
            {% endfor %}
        </table>
    </div>

    <div>*Values displayed are adjusted for inflation and represent an approximate current day equivalent price</div>

    <!-- Button labeled 'Done' to allow user to return to the homepage -->
    <div class="container">
        </br>
        <a href="/" class="btn btn-primary" role="button" type="button">Done</a>
    </div>
{% endblock %}